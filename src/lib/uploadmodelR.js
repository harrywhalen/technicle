import { doc, setDoc, serverTimestamp } from "firebase/firestore";
import { db } from "./firebase.js"; // adjust path


// rawData must be defined or imported
const rawData = {
    "Revenue": [
      365817.0,
      394328.0,
      383285.0,
      391035.0,
      399821.56,
      408805.56,
      417991.43
    ],
    "Cost of Goods Sold": [
      212981.0,
      223546.0,
      214137.0,
      210352.0,
      215078.61,
      219911.43,
      224852.85
    ],
    "Gross Profit": [
      152836.0,
      170782.0,
      169148.0,
      180683.0,
      184742.95,
      188894.13,
      193138.58
    ],
    "Selling General And Administration": [
      21973.0,
      25094.0,
      24932.0,
      26097.0,
      26683.4,
      27282.98,
      27896.03
    ],
    "Research and Development": [
      21914.0,
      26251.0,
      29915.0,
      31370.0,
      32074.88,
      32795.61,
      33532.53
    ],
    "Operating Expenses": [
      43887.0,
      51345.0,
      54847.0,
      57467.0,
      58758.28,
      60078.58,
      61428.55
    ],
    "EBITDA": [
      120233.0,
      130541.0,
      125820.0,
      134661.0,
      137801.62,
      140898.03,
      144064.01
    ],
    "Depreciation": [
      11284.0,
      11104.0,
      11519.0,
      11445.0,
      11816.96,
      12082.48,
      12353.98
    ],
    "Interest Expense": [
      2645.0,
      2931.0,
      3933.0,
      0.0,
      6341.0,
      6483.48,
      6629.16
    ],
    "Interest Income": [
      2843.0,
      2825.0,
      3750.0,
      0.0,
      1394.89,
      695.68,
      -19.23
    ],
    "EBT": [
      106304.0,
      116506.0,
      110368.0,
      123216.0,
      119643.67,
      122332.06,
      125080.87
    ],
    "Tax Provision": [
      21789.8,
      23887.4,
      22860.2,
      24643.2,
      25196.93,
      25763.11,
      26342.01
    ],
    "Tax Rate for Calcs": [
      0.2,
      0.2,
      0.2,
      0.2,
      0.2,
      0.2,
      0.2
    ],
    "Net Income": [
      84514.2,
      92618.6,
      87507.8,
      98572.8,
      94446.74,
      96568.96,
      98738.86
    ],
    "Gross Margin": [
      0.42,
      0.43,
      0.44,
      0.46,
      0.46,
      0.46,
      0.46
    ],
    "Net Margin": [
      0.23,
      0.23,
      0.23,
      0.25,
      0.24,
      0.24,
      0.24
    ],
    "": [
      "",
      "",
      "",
      "",
      "",
      "",
      ""
    ],
    "Operating Income": [
      108949.0,
      119437.0,
      114301.0,
      123216.0,
      125984.67,
      128815.54,
      131710.03
    ],
    "Cash and Cash Equivalents": [
      34940.0,
      36940.6,
      21421.4,
      27668.2,
      27897.8,
      13913.66,
      -384.7
    ],
    "Accounts Receivable": [
      26278.0,
      28184.0,
      29508.0,
      33410.0,
      30584.64,
      31271.87,
      31974.55
    ],
    "Accounts Payable": [
      54763.0,
      64115.0,
      62611.0,
      68960.0,
      70509.53,
      72093.88,
      73713.83
    ],
    "Inventory": [
      6580.0,
      4946.0,
      6331.0,
      7286.0,
      7449.72,
      7617.11,
      7788.27
    ],
    "Capital Expenditure": [
      -11085.0,
      -10708.0,
      -10959.0,
      -9447.0,
      -10995.41,
      -11242.48,
      -11495.09
    ],
    "Gross PPE": [
      119810.0,
      114457.0,
      114599.0,
      119128.0,
      130123.41,
      141365.88,
      152860.98
    ],
    "Net PPE": [
      119128.0,
      114599.0,
      114457.0,
      119810.0,
      118306.45,
      117466.44,
      116607.56
    ],
    "Total Assets": [
      254212.0,
      258376.0,
      247297.0,
      239711.0,
      244879.76,
      232369.69,
      219578.51
    ],
    "Total Debt": [
      136522.0,
      132480.0,
      111088.0,
      106629.0,
      126819.94,
      129669.58,
      132583.26
    ],
    "Current Debt": [
      15613.0,
      21110.0,
      15807.0,
      20879.0,
      19127.51,
      19557.31,
      19996.76
    ],
    "Long Term Debt": [
      109106.0,
      98959.0,
      95281.0,
      85750.0,
      101383.2,
      103661.28,
      105990.55
    ],
    "Total Liabilities": [
      191285.0,
      196595.0,
      173699.0,
      175589.0,
      197329.47,
      201763.46,
      206297.09
    ],
    "Common Stock": [
      57365.0,
      64849.0,
      73812.0,
      83276.0,
      83276.0,
      83276.0,
      83276.0
    ],
    "Dividends Paid": [
      -14467.0,
      -14841.0,
      -15025.0,
      -15234.0,
      -15349.51,
      -15694.41,
      -16047.07
    ],
    "Retained Earnings": [
      5562.0,
      -3068.0,
      -214.0,
      -19154.0,
      -35725.71,
      -52669.78,
      -69994.59
    ],
    "Total Equity": [
      62927.0,
      61781.0,
      73598.0,
      64122.0,
      47550.29,
      30606.22,
      13281.41
    ],
    "Net Working Capital": [
      -21905.0,
      -30985.0,
      -26772.0,
      -28264.0,
      -32475.18,
      -33204.9,
      -33951.01
    ],
    "Net Income from Continuing Operations": [
      84514.2,
      92618.6,
      87507.8,
      98572.8,
      94446.74,
      96568.96,
      98738.86
    ],
    "Cash Flow From Continuing Investing Activities": [
      -11085.0,
      -10708.0,
      -10959.0,
      -9447.0,
      -10995.41,
      -11242.48,
      -11495.09
    ],
    "Cash Flow From Continuing Operating Activities": [
      120891.2,
      113509.6,
      100443.8,
      120871.8,
      102052.51,
      107921.72,
      110346.73
    ],
    "Cash Flow From Continuing Financing Activities": [
      0.0,
      -100801.0,
      -105004.0,
      -105178.0,
      -90827.51,
      -110663.38,
      -113149.99
    ],
    "Depreciation and Amortization": [
      11284.0,
      11104.0,
      11519.0,
      11445.0,
      11816.96,
      12082.48,
      12353.98
    ],
    "Changes in Accounts Receivable": [
      -10125.0,
      -1823.0,
      -1688.0,
      -3788.0,
      2825.36,
      -687.24,
      -702.68
    ],
    "Changes in Accounts Payable": [
      12326.0,
      9448.0,
      -1889.0,
      6020.0,
      -1549.53,
      -1584.35,
      -1619.95
    ],
    "Changes in Inventory": [
      -2642.0,
      1484.0,
      -1618.0,
      -1046.0,
      -163.72,
      -167.4,
      -171.16
    ],
    "Changes in Cash": [
      109806.2,
      2000.6,
      -15519.2,
      6246.8,
      229.6,
      -13984.14,
      -14298.36
    ],
    "Inventory / COGS": 0.03,
    "Revenue Growth Rate": 0.02,
    "SGnA / Revenue": 0.07,
    "RnD / Revenue": 0.08,
    "Capex / Revenue": 0.03,
    "Accounts Receivable / Revenue": 0.08,
    "Accounts Payable / COGS": 0.33,
    "Interest Rate": 0.05,
    "Dividend Payout Ratio": 0.16,
    "Ebitda Margin": [
      0.33,
      0.33,
      0.33,
      0.34,
      0.34,
      0.34,
      0.34
    ],
    "Operating Margin": [
      0.3,
      0.3,
      0.3,
      0.32,
      0.32,
      0.32,
      0.32
    ],
    "Depreciation Rate": 1.07,
    "Return On Equity": [
      1.34,
      1.5,
      1.19,
      1.54,
      1.99,
      3.16,
      7.43
    ],
    "Return On Assets": [
      0.33,
      0.36,
      0.35,
      0.41,
      0.39,
      0.42,
      0.45
    ],
    "Current Ratio": [
      1.23,
      1.25,
      1.2,
      1.16,
      1.19,
      1.13,
      1.06
    ],
    "Debt / Ebitda": [
      1.14,
      1.01,
      0.88,
      0.79,
      0.92,
      0.92,
      0.92
    ],
    "Changes in Working Cap": [
      -25093.0,
      -9787.0,
      -1417.0,
      -10854.0,
      4211.18,
      729.72,
      746.11
    ],
    "COGS / Revenue": 0.54,
    "Opex / Revenue": 0.15,
    "Stock Buy Backs": [
      -85971.0,
      -89402.0,
      -77550.0,
      -94949.0,
      -95668.93,
      -97818.62,
      -100016.6
    ]
  }
const convertToOrderedArray = (obj) => {
  return Object.entries(obj).map(([label, values]) => ({ label, values }));
};

const orderedData = convertToOrderedArray(rawData);


const upload = async () => {
  const docRef = doc(db, "models", "MSFT 3 Statement");
  await setDoc(docRef, { orderedData });
};

upload();
