import { doc, setDoc, serverTimestamp } from "firebase/firestore";
import { db } from "./firebase.js"; // adjust path


// rawData must be defined or imported
const rawData = {
    "Revenue": [
      365817.0,
      394328.0,
      383285.0,
      391035.0,
      398941.705,
      407008.282,
      415237.966
    ],
    "Cost of Goods Sold": [
      212981.0,
      223546.0,
      214137.0,
      210352.0,
      214605.305,
      218944.612,
      223371.659
    ],
    "Gross Profit": [
      152836.0,
      170782.0,
      169148.0,
      180683.0,
      184336.4,
      188063.671,
      191866.307
    ],
    "Selling General And Administration": [
      21973.0,
      25094.0,
      24932.0,
      26097.0,
      26624.68,
      27163.029,
      27712.264
    ],
    "Research and Development": [
      21914.0,
      26251.0,
      29915.0,
      31370.0,
      32004.3,
      32651.425,
      33311.634
    ],
    "Operating Expenses": [
      32603.0,
      40241.0,
      43328.0,
      46022.0,
      46838.027,
      47785.089,
      48751.3
    ],
    "EBITDA": [
      120233.0,
      130541.0,
      125820.0,
      134661.0,
      137498.373,
      140278.582,
      143115.006
    ],
    "Depreciation": [
      11284.0,
      11104.0,
      11519.0,
      11445.0,
      11790.953,
      12029.365,
      12272.598
    ],
    "Interest Expense": [
      2645.0,
      2931.0,
      3933.0,
      0.0,
      6327.043,
      6454.975,
      6585.494
    ],
    "Interest Income": [
      2843.0,
      2825.0,
      3750.0,
      0.0,
      1386.242,
      679.751,
      -41.025
    ],
    "EBT": [
      106304.0,
      116506.0,
      110368.0,
      123216.0,
      119380.378,
      121794.242,
      124256.914
    ],
    "Tax Provision": [
      21789.8,
      23887.4,
      22860.2,
      24643.2,
      25141.484,
      25649.843,
      26168.482
    ],
    "Tax Rate for Calcs": [
      0.2,
      0.2,
      0.2,
      0.2,
      0.2,
      0.2,
      0.2
    ],
    "Net Income": [
      84514.2,
      92618.6,
      87507.8,
      98572.8,
      94238.894,
      96144.398,
      98088.432
    ],
    "Gross Margin": [
      0.418,
      0.433,
      0.441,
      0.462,
      0.462,
      0.462,
      0.462
    ],
    "Net Margin": [
      0.231,
      0.235,
      0.228,
      0.252,
      0.236,
      0.236,
      0.236
    ],
    "": [
      "",
      "",
      "",
      "",
      "",
      "",
      ""
    ],
    "Operating Income": [
      120233.0,
      130541.0,
      125820.0,
      134661.0,
      137498.373,
      140278.582,
      143115.006
    ],
    "Cash and Cash Equivalents": [
      34940.0,
      36940.6,
      21421.4,
      27668.2,
      27724.841,
      13595.024,
      -820.497
    ],
    "Accounts Receivable": [
      26278.0,
      28184.0,
      29508.0,
      33410.0,
      30517.332,
      31134.39,
      31763.926
    ],
    "Accounts Payable": [
      54763.0,
      64115.0,
      62611.0,
      68960.0,
      70354.367,
      71776.928,
      73228.253
    ],
    "Inventory": [
      6580.0,
      4946.0,
      6331.0,
      7286.0,
      7433.322,
      7583.624,
      7736.964
    ],
    "Capital Expenditure": [
      -11085.0,
      -10708.0,
      -10959.0,
      -9447.0,
      -10971.212,
      -11193.049,
      -11419.372
    ],
    "Gross PPE": [
      119810.0,
      114457.0,
      114599.0,
      119128.0,
      130099.212,
      141292.261,
      152711.634
    ],
    "Net PPE": [
      49527.0,
      42117.0,
      43715.0,
      45680.0,
      118308.259,
      117471.944,
      116618.718
    ],
    "Total Assets": [
      254212.0,
      258376.0,
      247297.0,
      239711.0,
      244481.98,
      231593.61,
      218444.638
    ],
    "Total Debt": [
      136522.0,
      132480.0,
      111088.0,
      106629.0,
      126540.851,
      129099.5,
      131709.884
    ],
    "Current Debt": [
      15613.0,
      21110.0,
      15807.0,
      20879.0,
      19085.422,
      19471.328,
      19865.037
    ],
    "Long Term Debt": [
      109106.0,
      98959.0,
      95281.0,
      85750.0,
      101160.093,
      103205.544,
      105292.354
    ],
    "Total Liabilities": [
      191285.0,
      196595.0,
      173699.0,
      175589.0,
      196895.218,
      200876.428,
      204938.138
    ],
    "Common Stock": [
      57365.0,
      64849.0,
      73812.0,
      83276.0,
      83276.0,
      83276.0,
      83276.0
    ],
    "Dividends Paid": [
      -14467.0,
      -14841.0,
      -15025.0,
      -15234.0,
      -15315.73,
      -15625.414,
      -15941.359
    ],
    "Retained Earnings": [
      5562.0,
      -3068.0,
      -214.0,
      -19154.0,
      -35689.238,
      -52558.818,
      -69769.499
    ],
    "Total Equity": [
      62927.0,
      61781.0,
      73598.0,
      64122.0,
      47586.762,
      30717.182,
      13506.501
    ],
    "Net Working Capital": [
      -21905.0,
      -30985.0,
      -26772.0,
      -28264.0,
      -32403.713,
      -33058.914,
      -33727.363
    ],
    "Net Income from Continuing Operations": [
      84514.2,
      92618.6,
      87507.8,
      98572.8,
      94238.894,
      96144.398,
      98088.432
    ],
    "Cash Flow From Continuing Investing Activities": [
      -11085.0,
      -10708.0,
      -10959.0,
      -9447.0,
      -10971.212,
      -11193.049,
      -11419.372
    ],
    "Cash Flow From Continuing Operating Activities": [
      120891.2,
      113509.6,
      100443.8,
      120871.8,
      101890.133,
      107518.562,
      109692.581
    ],
    "Cash Flow From Continuing Financing Activities": [
      0.0,
      -100801.0,
      -105004.0,
      -105178.0,
      -90862.28,
      -110455.33,
      -112688.73
    ],
    "Depreciation and Amortization": [
      11284.0,
      11104.0,
      11519.0,
      11445.0,
      11790.953,
      12029.365,
      12272.598
    ],
    "Changes in Accounts Receivable": [
      -10125.0,
      -1823.0,
      -1688.0,
      -3788.0,
      2892.668,
      -617.059,
      -629.536
    ],
    "Changes in Accounts Payable": [
      12326.0,
      9448.0,
      -1889.0,
      6020.0,
      -1394.367,
      -1422.561,
      -1451.325
    ],
    "Changes in Inventory": [
      -2642.0,
      1484.0,
      -1618.0,
      -1046.0,
      -147.322,
      -150.301,
      -153.34
    ],
    "Changes in Cash": [
      109806.2,
      2000.6,
      -15519.2,
      6246.8,
      56.641,
      -14129.817,
      -14415.521
    ],
    "Inventory / COGS": 0.035,
    "Revenue Growth Rate": 0.02,
    "SGnA / Revenue": 0.067,
    "RnD / Revenue": 0.08,
    "Capex / Revenue": 0.028,
    "Accounts Receivable / Revenue": 0.076,
    "Accounts Payable / COGS": 0.328,
    "Interest Rate": 0.05,
    "Dividend Payout Ratio": 0.163,
    "Ebitda Margin": [
      0.329,
      0.331,
      0.328,
      0.344,
      0.345,
      0.345,
      0.345
    ],
    "Operating Margin": [
      0.329,
      0.331,
      0.328,
      0.344,
      0.345,
      0.345,
      0.345
    ],
    "Depreciation Rate": 1.075,
    "Return On Equity": [
      1.343,
      1.499,
      1.189,
      1.537,
      1.98,
      3.13,
      7.262
    ],
    "Return On Assets": [
      0.332,
      0.358,
      0.354,
      0.411,
      0.385,
      0.415,
      0.449
    ],
    "Current Ratio": [
      1.24,
      1.261,
      1.207,
      1.17,
      1.193,
      1.13,
      1.066
    ],
    "Debt / Ebitda": [
      1.135,
      1.015,
      0.883,
      0.792,
      0.92,
      0.92,
      0.92
    ],
    "Changes in Working Cap": [
      -25093.0,
      -9787.0,
      -1417.0,
      -10854.0,
      4139.713,
      655.201,
      668.449
    ],
    "COGS / Revenue": 0.538,
    "Opex / Revenue": 0.118,
    "Stock Buy Backs": [
      -85971.0,
      -89402.0,
      -77550.0,
      -94949.0,
      -95458.401,
      -97388.565,
      -99357.756
    ]
  }
const convertToOrderedArray = (obj) => {
  return Object.entries(obj).map(([label, values]) => ({ label, values }));
};

const orderedData = convertToOrderedArray(rawData);


const upload = async () => {
  const docRef = doc(db, "models", "MSFT 3 Statement");
  await setDoc(docRef, { orderedData });
};

upload();
