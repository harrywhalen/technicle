import { doc, setDoc, serverTimestamp } from "firebase/firestore";
import { db } from "./firebase.js"; // adjust path


// rawData must be defined or imported
const rawData = {
    "Revenue": [
      365817.0,
      394328.0,
      383285.0,
      391035.0,
      398941.7045410073,
      407008.2821795603,
      415237.9655402229
    ],
    "Cost of Goods Sold": [
      212981.0,
      223546.0,
      214137.0,
      210352.0,
      214605.30498193248,
      218944.61153869826,
      223371.65861704698
    ],
    "Gross Profit": [
      152836.0,
      170782.0,
      169148.0,
      180683.0,
      184336.3995590748,
      188063.67064086202,
      191866.3069231759
    ],
    "Selling General And Administration": [
      21973.0,
      25094.0,
      24932.0,
      26097.0,
      26624.679794408854,
      27163.029243008896,
      27712.26408557596
    ],
    "Research and Development": [
      21914.0,
      26251.0,
      29915.0,
      31370.0,
      32004.299542116172,
      32651.424583407636,
      33311.634454708124
    ],
    "Operating Expenses": [
      32603.0,
      40241.0,
      43328.0,
      46022.0,
      46838.02666941058,
      47785.08879469054,
      48751.300460054044
    ],
    "EBITDA": [
      120233.0,
      130541.0,
      125820.0,
      134661.0,
      137498.37288966423,
      140278.58184617147,
      143115.00646312186
    ],
    "Depreciation": [
      11284.0,
      11104.0,
      11519.0,
      11445.0,
      11790.952667114441,
      12029.365031725987,
      12272.598080230038
    ],
    "Interest Expense": [
      2645.0,
      2931.0,
      3933.0,
      0.0,
      6327.042568337973,
      6454.9749943515635,
      6585.4942064423685
    ],
    "Interest Income": [
      2843.0,
      2825.0,
      3750.0,
      0.0,
      1386.2420388360079,
      679.7512058217762,
      -41.0248299941828
    ],
    "EBT": [
      106304.0,
      116506.0,
      110368.0,
      123216.0,
      119380.37765421181,
      121794.24182009391,
      124256.91417644946
    ],
    "Tax Provision": [
      21789.800000000003,
      23887.4,
      22860.2,
      24643.2,
      25141.484044509958,
      25649.843362889096,
      26168.481676578365
    ],
    "Tax Rate for Calcs": [
      0.2,
      0.2,
      0.2,
      0.2,
      0.2,
      0.2,
      0.2
    ],
    "Net Income": [
      84514.2,
      92618.6,
      87507.8,
      98572.8,
      94238.89360970186,
      96144.39845720482,
      98088.4324998711
    ],
    "Gross Margin": [
      0.418,
      0.433,
      0.441,
      0.462,
      0.462,
      0.462,
      0.462
    ],
    "Net Margin": [
      0.231,
      0.235,
      0.228,
      0.252,
      0.236,
      0.236,
      0.236
    ],
    "": [
      "",
      "",
      "",
      "",
      "",
      "",
      ""
    ],
    "Operating Income": [
      120233.0,
      130541.0,
      125820.0,
      134661.0,
      137498.37288966423,
      140278.58184617147,
      143115.00646312186
    ],
    "Cash and Cash Equivalents": [
      34940.0,
      36940.600000000006,
      21421.40000000001,
      27668.20000000001,
      27724.840776720157,
      13595.024116435525,
      -820.496599883656
    ],
    "Accounts Receivable": [
      26278.0,
      28184.0,
      29508.0,
      33410.0,
      30517.33162960604,
      31134.390267772014,
      31763.925795056493
    ],
    "Accounts Payable": [
      54763.0,
      64115.0,
      62611.0,
      68960.0,
      70354.36711585373,
      71776.92825220883,
      73228.25349049004
    ],
    "Inventory": [
      6580.0,
      4946.0,
      6331.0,
      7286.0,
      7433.322488487678,
      7583.623828967424,
      7736.964253650093
    ],
    "Capital Expenditure": [
      -11085.0,
      -10708.0,
      -10959.0,
      -9447.0,
      -10971.212109709877,
      -11193.049368799722,
      -11419.372164130082
    ],
    "Gross PPE": [
      119810.0,
      114457.0,
      114599.0,
      119128.0,
      130099.21210970987,
      141292.26147850958,
      152711.63364263967
    ],
    "Net PPE": [
      49527.0,
      42117.0,
      43715.0,
      45680.0,
      118308.25944259543,
      117471.94377966915,
      116618.71786356921
    ],
    "Total Assets": [
      254212.0,
      258376.0,
      247297.0,
      239711.0,
      244481.98033292932,
      231593.6103037829,
      218444.63819595904
    ],
    "Total Debt": [
      136522.0,
      132480.0,
      111088.0,
      106629.0,
      126540.85136675945,
      129099.49988703126,
      131709.88412884736
    ],
    "Current Debt": [
      15613.0,
      21110.0,
      15807.0,
      20879.0,
      19085.421686809936,
      19471.327782985827,
      19865.036877571158
    ],
    "Long Term Debt": [
      109106.0,
      98959.0,
      95281.0,
      85750.0,
      101160.09258607253,
      103205.5436669707,
      105292.35364758309
    ],
    "Total Liabilities": [
      191285.0,
      196595.0,
      173699.0,
      175589.0,
      196895.21848261319,
      200876.42813924007,
      204938.13761933742
    ],
    "Common Stock": [
      57365.0,
      64849.0,
      73812.0,
      83276.0,
      83276.0,
      83276.0,
      83276.0
    ],
    "Dividends Paid": [
      -14467.0,
      -14841.0,
      -15025.0,
      -15234.0,
      -15315.730405075938,
      -15625.413566794596,
      -15941.358503702273
    ],
    "Retained Earnings": [
      5562.0,
      -3068.0,
      -214.0,
      -19154.0,
      -35689.238149683864,
      -52558.81783545719,
      -69769.49942337837
    ],
    "Total Equity": [
      62927.0,
      61781.0,
      73598.0,
      64122.0,
      47586.761850316136,
      30717.182164542814,
      13506.500576621635
    ],
    "Net Working Capital": [
      -21905.0,
      -30985.0,
      -26772.0,
      -28264.0,
      -32403.712997760013,
      -33058.91415546939,
      -33727.363441783455
    ],
    "Net Income from Continuing Operations": [
      84514.2,
      92618.6,
      87507.8,
      98572.8,
      94238.89360970186,
      96144.39845720482,
      98088.4324998711
    ],
    "Cash Flow From Continuing Investing Activities": [
      -11085.0,
      -10708.0,
      -10959.0,
      -9447.0,
      -10971.212109709877,
      -11193.049368799722,
      -11419.372164130082
    ],
    "Cash Flow From Continuing Operating Activities": [
      120891.2,
      113509.6,
      100443.8,
      120871.8,
      101890.13327905629,
      107518.56233122143,
      109692.58129378707
    ],
    "Cash Flow From Continuing Financing Activities": [
      0,
      -100801.0,
      -105004.0,
      -105178.0,
      -90862.28039262627,
      -110455.32962270634,
      -112688.72984597617
    ],
    "Depreciation and Amortization": [
      11284.0,
      11104.0,
      11519.0,
      11445.0,
      11790.952667114441,
      12029.365031725987,
      12272.598080230038
    ],
    "Changes in Accounts Receivable": [
      -10125.0,
      -1823.0,
      -1688.0,
      -3788.0,
      2892.66837039396,
      -617.0586381659741,
      -629.535527284479
    ],
    "Changes in Accounts Payable": [
      12326.0,
      9448.0,
      -1889.0,
      6020.0,
      -1394.3671158537327,
      -1422.5611363550997,
      -1451.325238281206
    ],
    "Changes in Inventory": [
      -2642.0,
      1484.0,
      -1618.0,
      -1046.0,
      -147.32248848767813,
      -150.3013404797457,
      -153.34042468266944
    ],
    "Changes in Cash": [
      109806.2,
      2000.6000000000058,
      -15519.199999999997,
      6246.800000000003,
      56.64077672014537,
      -14129.816660284632,
      -14415.52071631918
    ],
    "Inventory / COGS": 0.035,
    "Revenue Growth Rate": 0.020219940775141214,
    "SGnA / Revenue": 0.067,
    "RnD / Revenue": 0.08,
    "Capex / Revenue": 0.028,
    "Accounts Receivable / Revenue": 0.076,
    "Accounts Payable / COGS": 0.328,
    "Interest Rate": 0.05,
    "Dividend Payout Ratio": 0.163,
    "Ebitda Margin": [
      0.329,
      0.331,
      0.328,
      0.344,
      0.345,
      0.345,
      0.345
    ],
    "Operating Margin": [
      0.329,
      0.331,
      0.328,
      0.344,
      0.345,
      0.345,
      0.345
    ],
    "Depreciation Rate": 1.075,
    "Return On Equity": [
      1.343,
      1.499,
      1.189,
      1.537,
      1.98,
      3.13,
      7.262
    ],
    "Return On Assets": [
      0.332,
      0.358,
      0.354,
      0.411,
      0.385,
      0.415,
      0.449
    ],
    "Current Ratio": [
      1.24,
      1.261,
      1.207,
      1.17,
      1.193,
      1.13,
      1.066
    ],
    "Debt / Ebitda": [
      1.135,
      1.015,
      0.883,
      0.792,
      0.92,
      0.92,
      0.92
    ],
    "Changes in Working Cap": [
      -25093.0,
      -9787.0,
      -1417.0,
      -10854.0,
      4139.712997760014,
      655.2011577093799,
      668.4492863140576
    ],
    "COGS / Revenue": 0.538,
    "Opex / Revenue": 0.118,
    "Stock Buy Backs": [
      -85971.0,
      -89402.0,
      -77550.0,
      -94949.0,
      -95458.40135430978,
      -97388.56457618355,
      -99357.75558409
    ]
  }
const convertToOrderedArray = (obj) => {
  return Object.entries(obj).map(([label, values]) => ({ label, values }));
};

const orderedData = convertToOrderedArray(rawData);


const upload = async () => {
  const docRef = doc(db, "models", "MSFT 3 Statement");
  await setDoc(docRef, { orderedData });
};

upload();
