import { doc, setDoc, serverTimestamp } from "firebase/firestore";
import { db } from "./firebase.js"; // adjust path


// rawData must be defined or imported
const rawData = {
    "Revenue": [
      168088.0,
      198270.0,
      211915.0,
      245122.0,
      277969.72,
      315219.21,
      357460.35
    ],
    "Cost of Goods Sold": [
      52232.0,
      62650.0,
      65863.0,
      74114.0,
      84045.69,
      95308.28,
      108080.12
    ],
    "Gross Profit": [
      115856.0,
      135620.0,
      146052.0,
      171008.0,
      193924.03,
      219910.93,
      249380.22
    ],
    "Selling General And Administration": [
      25224.0,
      27725.0,
      30334.0,
      32065.0,
      36361.89,
      41234.59,
      46760.25
    ],
    "Research and Development": [
      20716.0,
      24512.0,
      27195.0,
      29510.0,
      33464.5,
      37948.94,
      43034.3
    ],
    "Operating Expenses": [
      45940.0,
      52237.0,
      57529.0,
      61575.0,
      69826.39,
      79183.52,
      89794.55
    ],
    "EBITDA": [
      81602.0,
      97843.0,
      102384.0,
      131720.0,
      145127.45,
      164575.34,
      186629.35
    ],
    "Depreciation": [
      11686.0,
      14460.0,
      13861.0,
      22287.0,
      21029.82,
      23847.93,
      27043.68
    ],
    "Interest Expense": [
      2346.0,
      2063.0,
      1968.0,
      2935.0,
      4323.46,
      4902.83,
      5559.84
    ],
    "Interest Income": [
      2131.0,
      2094.0,
      2994.0,
      3157.0,
      7592.77,
      10397.14,
      13577.3
    ],
    "EBT": [
      67570.0,
      81320.0,
      86555.0,
      106498.0,
      119774.17,
      135824.58,
      154025.83
    ],
    "Tax Provision": [
      13983.2,
      16676.6,
      17704.6,
      21886.6,
      24819.53,
      28145.48,
      31917.13
    ],
    "Tax Rate for Calcs": [
      0.2,
      0.2,
      0.2,
      0.2,
      0.2,
      0.2,
      0.2
    ],
    "Net Income": [
      53586.8,
      64643.4,
      68850.4,
      84611.4,
      94954.65,
      107679.1,
      122108.7
    ],
    "Gross Margin": [
      0.69,
      0.68,
      0.69,
      0.7,
      0.7,
      0.7,
      0.7
    ],
    "Net Margin": [
      0.32,
      0.33,
      0.32,
      0.35,
      0.34,
      0.34,
      0.34
    ],
    "": [
      "",
      "",
      "",
      "",
      "",
      "",
      ""
    ],
    "Operating Income": [
      69916.0,
      83383.0,
      88523.0,
      109433.0,
      124097.63,
      140727.41,
      159585.67
    ],
    "Cash and Cash Equivalents": [
      14224.0,
      27529.4,
      45328.8,
      94231.2,
      151855.42,
      207942.75,
      271546.1
    ],
    "Accounts Receivable": [
      38794.0,
      44894.0,
      49338.0,
      57754.0,
      64405.37,
      73036.05,
      82823.29
    ],
    "Accounts Payable": [
      15163.0,
      19000.0,
      18095.0,
      21996.0,
      24943.59,
      28286.17,
      32076.67
    ],
    "Inventory": [
      2636.0,
      3742.0,
      2500.0,
      1246.0,
      1412.97,
      1602.32,
      1817.04
    ],
    "Capital Expenditure": [
      -20622.0,
      -23886.0,
      -28107.0,
      -44477.0,
      -39529.06,
      -44826.17,
      -50833.13
    ],
    "Gross PPE": [
      122154.0,
      147206.0,
      178238.0,
      230973.0,
      270502.06,
      315328.23,
      366161.37
    ],
    "Net PPE": [
      230973.0,
      178238.0,
      147206.0,
      122154.0,
      249472.24,
      270450.49,
      294239.94
    ],
    "Total Assets": [
      223104.0,
      251490.0,
      290626.0,
      363190.0,
      438390.29,
      513321.0,
      598292.85
    ],
    "Total Debt": [
      67775.0,
      61270.0,
      59965.0,
      67127.0,
      86469.23,
      98056.59,
      111196.72
    ],
    "Current Debt": [
      8072.0,
      2749.0,
      5247.0,
      8942.0,
      8443.12,
      9574.55,
      10857.59
    ],
    "Long Term Debt": [
      50074.0,
      47032.0,
      41990.0,
      42688.0,
      61368.42,
      69592.13,
      78917.86
    ],
    "Total Liabilities": [
      82938.0,
      80270.0,
      78060.0,
      89123.0,
      111412.81,
      126342.75,
      143273.39
    ],
    "Common Stock": [
      83111.0,
      86939.0,
      93718.0,
      100923.0,
      100923.0,
      100923.0,
      100923.0
    ],
    "Dividends Paid": [
      -16521.0,
      -18135.0,
      -19800.0,
      -21771.0,
      -23455.31,
      -26598.46,
      -30162.8
    ],
    "Retained Earnings": [
      57055.0,
      84281.0,
      118848.0,
      173144.0,
      226054.47,
      286055.25,
      354096.46
    ],
    "Total Equity": [
      140166.0,
      171220.0,
      212566.0,
      274067.0,
      326977.47,
      386978.25,
      455019.46
    ],
    "Net Working Capital": [
      26267.0,
      29636.0,
      33743.0,
      37004.0,
      40874.76,
      46352.2,
      52563.66
    ],
    "Net Income from Continuing Operations": [
      53586.8,
      64643.4,
      68850.4,
      84611.4,
      94954.65,
      107679.1,
      122108.7
    ],
    "Cash Flow From Continuing Investing Activities": [
      -20622.0,
      -23886.0,
      -28107.0,
      -44477.0,
      -39529.06,
      -44826.17,
      -50833.13
    ],
    "Cash Flow From Continuing Operating Activities": [
      72979.8,
      90699.4,
      82477.4,
      118037.4,
      119855.22,
      137004.47,
      155363.84
    ],
    "Cash Flow From Continuing Financing Activities": [
      0.0,
      -53508.0,
      -36571.0,
      -24658.0,
      -22701.94,
      -36090.96,
      -40927.36
    ],
    "Depreciation and Amortization": [
      11686.0,
      14460.0,
      13861.0,
      22287.0,
      21029.82,
      23847.93,
      27043.68
    ],
    "Changes in Accounts Receivable": [
      -6481.0,
      -6834.0,
      -4087.0,
      -7191.0,
      -6651.37,
      -8630.68,
      -9787.24
    ],
    "Changes in Accounts Payable": [
      489.0,
      3639.0,
      -3079.0,
      5232.0,
      -2947.59,
      -3342.58,
      -3790.5
    ],
    "Changes in Inventory": [
      -737.0,
      -1123.0,
      1242.0,
      1284.0,
      -166.97,
      -189.35,
      -214.72
    ],
    "Changes in Cash": [
      52357.8,
      13305.4,
      17799.4,
      48902.4,
      57624.22,
      56087.33,
      63603.35
    ],
    "Inventory / COGS": 0.02,
    "Revenue Growth Rate": 0.13,
    "SGnA / Revenue": 0.13,
    "RnD / Revenue": 0.12,
    "Capex / Revenue": 0.14,
    "Accounts Receivable / Revenue": 0.23,
    "Accounts Payable / COGS": 0.3,
    "Interest Rate": 0.05,
    "Dividend Payout Ratio": 0.25,
    "Ebitda Margin": [
      0.49,
      0.49,
      0.48,
      0.54,
      0.52,
      0.52,
      0.52
    ],
    "Operating Margin": [
      0.42,
      0.42,
      0.42,
      0.45,
      0.45,
      0.45,
      0.45
    ],
    "Depreciation Rate": 0.53,
    "Return On Equity": [
      0.38,
      0.38,
      0.32,
      0.31,
      0.29,
      0.28,
      0.27
    ],
    "Return On Assets": [
      0.24,
      0.26,
      0.24,
      0.23,
      0.22,
      0.21,
      0.2
    ],
    "Current Ratio": [
      1.56,
      1.76,
      2.03,
      2.53,
      3.06,
      3.58,
      4.18
    ],
    "Debt / Ebitda": [
      0.83,
      0.63,
      0.59,
      0.51,
      0.6,
      0.6,
      0.6
    ],
    "Changes in Working Cap": [
      -7707.0,
      -11596.0,
      234.0,
      -11139.0,
      -3870.76,
      -5477.45,
      -6211.45
    ],
    "COGS / Revenue": 0.3,
    "Opex / Revenue": 0.25,
    "Stock Buy Backs": [
      -27385.0,
      -32696.0,
      -22245.0,
      -17254.0,
      -18588.86,
      -21079.87,
      -23904.69
    ]
  }
const convertToOrderedArray = (obj) => {
  return Object.entries(obj).map(([label, values]) => ({ label, values }));
};

const orderedData = convertToOrderedArray(rawData);


const upload = async () => {
  const docRef = doc(db, "models", "MSFT 3 Statement");
  await setDoc(docRef, { orderedData });
};

upload();
